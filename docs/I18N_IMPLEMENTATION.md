# NasCode å›½é™…åŒ–(i18n)åŠŸèƒ½å®ç°æ€»ç»“

## å®ç°æ¦‚è¿°

ä¸ºNasCodeæ·»åŠ äº†å®Œæ•´çš„å¤šè¯­è¨€æ”¯æŒ,æ”¯æŒä¸­è‹±æ–‡ç•Œé¢åˆ‡æ¢,å¹¶æä¾›äº†å¯æ‰©å±•çš„ç¿»è¯‘æ¡†æ¶ã€‚

## å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒç»„ä»¶

#### I18nManagerç±» (`src/core/I18nManager.h/cpp`)
- **åŠŸèƒ½**: å•ä¾‹æ¨¡å¼çš„å›½é™…åŒ–ç®¡ç†å™¨
- **ä¸»è¦ç‰¹æ€§**:
  - æ”¯æŒå¤šè¯­è¨€åˆ‡æ¢(English, Chinese)
  - è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿè¯­è¨€
  - è¯­è¨€è®¾ç½®æŒä¹…åŒ–(ä½¿ç”¨QSettings)
  - åŒæ—¶åŠ è½½åº”ç”¨å’ŒQtæ ‡å‡†ç¿»è¯‘
  - å‘é€è¯­è¨€åˆ‡æ¢ä¿¡å·é€šçŸ¥æ‰€æœ‰çª—å£

```cpp
// ä½¿ç”¨ç¤ºä¾‹
auto& i18n = I18nManager::getInstance();
i18n.initialize();  // åˆå§‹åŒ–,åŠ è½½ä¿å­˜çš„è¯­è¨€æˆ–ç³»ç»Ÿè¯­è¨€
i18n.switchLanguage(I18nManager::Chinese);  // åˆ‡æ¢åˆ°ä¸­æ–‡
```

### 2. ç¿»è¯‘æ–‡ä»¶

#### ä¸­æ–‡ç¿»è¯‘ (`translations/nascode_zh_CN.ts`)
- å®Œæ•´çš„ä¸»çª—å£èœå•ç¿»è¯‘
- å·¥å…·æ å’Œåœé çª—å£ç¿»è¯‘
- å¯¹è¯æ¡†å’ŒçŠ¶æ€æ¶ˆæ¯ç¿»è¯‘
- 46æ¡ç¿»è¯‘å®Œæˆ

#### è‹±æ–‡ç¿»è¯‘ (`translations/nascode_en_US.ts`)
- å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘(é»˜è®¤ä¿æŒåŸæ–‡)
- 46æ¡ç¿»è¯‘å®Œæˆ

ç¿»è¯‘è¦†ç›–èŒƒå›´:
- âœ… æ–‡ä»¶èœå• (New, Open, Save, Close, Exit)
- âœ… ç¼–è¾‘èœå• (Undo, Redo, Cut, Copy, Paste)
- âœ… æ„å»ºèœå• (Build, Rebuild, Clean)
- âœ… è°ƒè¯•èœå• (Download, Start, Stop, Pause)
- âœ… å·¥å…·èœå• (Language submenu)
- âœ… å¸®åŠ©èœå•
- âœ… å·¥å…·æ æ ‡é¢˜
- âœ… åœé çª—å£ (Output, Watch, Library)
- âœ… çŠ¶æ€æ æ¶ˆæ¯

### 3. ä¸»çª—å£é›†æˆ

#### MainWindowç±»æ›´æ–°
- æ·»åŠ è¯­è¨€åˆ‡æ¢èœå• (å·¥å…· â†’ è¯­è¨€)
- å®ç°`changeEvent()`ç›‘å¬è¯­è¨€å˜åŒ–
- å®ç°`retranslateUi()`åŠ¨æ€æ›´æ–°ç•Œé¢æ–‡æœ¬
- æ·»åŠ è¯­è¨€é€‰æ‹©ActionGroup

```cpp
// è¯­è¨€åˆ‡æ¢èœå•
å·¥å…·(Tools) â†’ è¯­è¨€(Language)
    â”œâ”€ English  â˜
    â””â”€ Chinese  â˜‘
```

### 4. Applicationç±»é›†æˆ

åœ¨åº”ç”¨åˆå§‹åŒ–æ—¶è‡ªåŠ¨åŠ è½½å›½é™…åŒ–ç³»ç»Ÿ:

```cpp
// Application::initialize()
I18nManager::getInstance().initialize();
```

### 5. æ„å»ºç³»ç»Ÿé…ç½®

#### CMakeLists.txtæ›´æ–°
- å¯ç”¨Qt LinguistTools
- è‡ªåŠ¨ç¼–è¯‘.tsåˆ°.qm
- åˆ›å»ºtranslationsç›®æ ‡
- å®‰è£…ç¿»è¯‘æ–‡ä»¶åˆ°bin/translations

```cmake
find_package(Qt6 REQUIRED COMPONENTS ... LinguistTools)
qt6_add_translation(QM_FILES ${TS_FILES})
add_custom_target(translations ALL DEPENDS ${QM_FILES})
install(FILES ${QM_FILES} DESTINATION bin/translations)
```

### 6. å·¥å…·å’Œè„šæœ¬

#### update_translations.sh
è‡ªåŠ¨æ›´æ–°ç¿»è¯‘æ–‡ä»¶çš„è„šæœ¬:
```bash
./update_translations.sh
```
- æ‰«ææ‰€æœ‰æºæ–‡ä»¶
- æå–tr()æ ‡è®°çš„æ–‡æœ¬
- æ›´æ–°.tsæ–‡ä»¶
- å‡†å¤‡å¥½ä¾›Qt Linguistç¼–è¾‘

### 7. æ–‡æ¡£

#### I18N_GUIDE.md
å®Œæ•´çš„å›½é™…åŒ–æŒ‡å—,åŒ…å«:
- ç”¨æˆ·ä½¿ç”¨æŒ‡å—
- å¼€å‘è€…æŒ‡å—
- æ·»åŠ æ–°è¯­è¨€æ­¥éª¤
- æœ€ä½³å®è·µ
- å¸¸è§é—®é¢˜è§£ç­”

## æŠ€æœ¯æ¶æ„

### ç¿»è¯‘æµç¨‹

```
æºä»£ç ä¸­çš„tr() â†’ æ›´æ–°.tsæ–‡ä»¶ â†’ Qt Linguistç¼–è¾‘ â†’ ç¼–è¯‘.qm â†’ è¿è¡Œæ—¶åŠ è½½
     â†“              â†“                â†“              â†“           â†“
  MainWindow.cpp  update_trans.sh  linguist    CMake/lrelease  I18nManager
```

### è¿è¡Œæ—¶åŠ è½½æœºåˆ¶

```
åº”ç”¨å¯åŠ¨
    â†“
Application::initialize()
    â†“
I18nManager::initialize()
    â†“
è¯»å–QSettingsè·å–ä¿å­˜çš„è¯­è¨€
    â†“
æˆ–æ£€æµ‹ç³»ç»Ÿè¯­è¨€(zh_CN â†’ Chinese, å…¶ä»– â†’ English)
    â†“
åŠ è½½å¯¹åº”çš„.qmæ–‡ä»¶
    â†“
QApplication::installTranslator()
    â†“
ç•Œé¢æ˜¾ç¤ºå¯¹åº”è¯­è¨€
```

### åŠ¨æ€åˆ‡æ¢æœºåˆ¶

```
ç”¨æˆ·é€‰æ‹©è¯­è¨€
    â†“
onLanguageChanged()
    â†“
I18nManager::switchLanguage()
    â†“
ç§»é™¤æ—§translator + åŠ è½½æ–°translator
    â†“
å‘å‡ºlanguageChangedä¿¡å·
    â†“
æ‰€æœ‰çª—å£çš„changeEvent()è¢«è§¦å‘
    â†“
è°ƒç”¨retranslateUi()æ›´æ–°ç•Œé¢
```

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
```
translations/
â”œâ”€â”€ nascode_zh_CN.ts        # ä¸­æ–‡ç¿»è¯‘æºæ–‡ä»¶
â”œâ”€â”€ nascode_en_US.ts        # è‹±æ–‡ç¿»è¯‘æºæ–‡ä»¶
â””â”€â”€ README.md               # ç¿»è¯‘è¯´æ˜

src/core/
â”œâ”€â”€ I18nManager.h           # å›½é™…åŒ–ç®¡ç†å™¨å¤´æ–‡ä»¶
â””â”€â”€ I18nManager.cpp         # å›½é™…åŒ–ç®¡ç†å™¨å®ç°

docs/
â””â”€â”€ I18N_GUIDE.md           # å›½é™…åŒ–å®Œæ•´æŒ‡å—

update_translations.sh      # ç¿»è¯‘æ›´æ–°è„šæœ¬
```

### ä¿®æ”¹æ–‡ä»¶
```
src/core/
â”œâ”€â”€ CMakeLists.txt          # æ·»åŠ I18nManager
â”œâ”€â”€ Application.h           # é›†æˆI18nManager
â””â”€â”€ Application.cpp         # åˆå§‹åŒ–i18n

src/views/
â”œâ”€â”€ MainWindow.h            # æ·»åŠ è¯­è¨€èœå•å’Œæ–¹æ³•
â””â”€â”€ MainWindow.cpp          # å®ç°è¯­è¨€åˆ‡æ¢

CMakeLists.txt              # é…ç½®ç¿»è¯‘ç³»ç»Ÿ
```

## ä½¿ç”¨æ–¹å¼

### ç”¨æˆ·è§†è§’

1. **é¦–æ¬¡å¯åŠ¨**: è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿè¯­è¨€
   - ä¸­æ–‡ç³»ç»Ÿ â†’ ä¸­æ–‡ç•Œé¢
   - å…¶ä»–ç³»ç»Ÿ â†’ è‹±æ–‡ç•Œé¢

2. **æ‰‹åŠ¨åˆ‡æ¢è¯­è¨€**:
   ```
   å·¥å…·(Tools) â†’ è¯­è¨€(Language) â†’ é€‰æ‹©è¯­è¨€
   ```

3. **é‡å¯åº”ç”¨**: ä¿æŒä¸Šæ¬¡é€‰æ‹©çš„è¯­è¨€

### å¼€å‘è€…è§†è§’

1. **æ·»åŠ å¯ç¿»è¯‘æ–‡æœ¬**:
   ```cpp
   QString text = tr("Your text here");
   ```

2. **æ›´æ–°ç¿»è¯‘æ–‡ä»¶**:
   ```bash
   ./update_translations.sh
   ```

3. **ç¼–è¾‘ç¿»è¯‘** (ä½¿ç”¨Qt Linguist):
   ```bash
   linguist translations/nascode_zh_CN.ts
   ```

4. **ç¼–è¯‘é¡¹ç›®**:
   ```bash
   ./build.sh
   ```

5. **æµ‹è¯•**:
   ```bash
   ./build/NasCode
   ```

## æµ‹è¯•éªŒè¯

### ç¼–è¯‘ç»“æœ
```
âœ“ I18nManagerç¼–è¯‘æˆåŠŸ
âœ“ MainWindowæ›´æ–°ç¼–è¯‘æˆåŠŸ
âœ“ ç”Ÿæˆnascode_zh_CN.qm (46æ¡ç¿»è¯‘)
âœ“ ç”Ÿæˆnascode_en_US.qm (46æ¡ç¿»è¯‘)
âœ“ å¯æ‰§è¡Œæ–‡ä»¶ç”ŸæˆæˆåŠŸ
```

### åŠŸèƒ½éªŒè¯
- [x] åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½æ­£ç¡®è¯­è¨€
- [x] èœå•æ æ­£ç¡®æ˜¾ç¤ºç¿»è¯‘
- [x] å·¥å…·æ æ­£ç¡®æ˜¾ç¤ºç¿»è¯‘
- [x] åœé çª—å£æ ‡é¢˜æ­£ç¡®ç¿»è¯‘
- [x] è¯­è¨€èœå•æ˜¾ç¤ºå¹¶å¯é€‰æ‹©
- [x] åˆ‡æ¢è¯­è¨€åŠŸèƒ½æ­£å¸¸
- [x] è¯­è¨€è®¾ç½®æŒä¹…åŒ–

## æ‰©å±•æ€§

### æ·»åŠ æ–°è¯­è¨€åªéœ€4æ­¥

1. å¤åˆ¶ç¿»è¯‘æ¨¡æ¿:
   ```bash
   cp translations/nascode_en_US.ts translations/nascode_ja_JP.ts
   ```

2. æ›´æ–°CMakeLists.txt:
   ```cmake
   set(TS_FILES
       ...
       ${CMAKE_SOURCE_DIR}/translations/nascode_ja_JP.ts
   )
   ```

3. æ›´æ–°I18nManageræšä¸¾:
   ```cpp
   enum Language { English, Chinese, Japanese, ... };
   ```

4. å®ç°åŠ è½½é€»è¾‘:
   ```cpp
   case Japanese:
       translationFile = "nascode_ja_JP";
       break;
   ```

## æœ€ä½³å®è·µåº”ç”¨

### âœ… æ­£ç¡®ä½¿ç”¨tr()
```cpp
// æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬éƒ½ä½¿ç”¨tr()
QString msg = tr("Build successful");
QAction* act = new QAction(tr("&Open"), this);
```

### âœ… æ”¯æŒå‚æ•°æ›¿æ¢
```cpp
QString msg = tr("Found %1 errors").arg(errorCount);
```

### âœ… æä¾›ä¸Šä¸‹æ–‡æ³¨é‡Š
```cpp
//: ä¸»å·¥å…·æ çš„æ‰“å¼€æŒ‰é’®
QString text = tr("Open");
```

### âœ… å¤„ç†å¤æ•°å½¢å¼
```cpp
QString msg = tr("%n file(s)", "", count);
```

## æ€§èƒ½è€ƒè™‘

- **å¯åŠ¨æ—¶åŠ è½½**: ç¿»è¯‘æ–‡ä»¶åœ¨åº”ç”¨åˆå§‹åŒ–æ—¶ä¸€æ¬¡æ€§åŠ è½½,å¼€é”€å¯å¿½ç•¥
- **.qmæ–‡ä»¶å¤§å°**: å½“å‰çº¦10KB,éšç¿»è¯‘å¢åŠ è€Œå¢é•¿,ä½†ä»ç„¶å¾ˆå°
- **è¿è¡Œæ—¶æŸ¥æ‰¾**: Qtä½¿ç”¨å“ˆå¸Œè¡¨,tr()è°ƒç”¨éå¸¸å¿«é€Ÿ
- **å†…å­˜å ç”¨**: ä»…åŠ è½½å½“å‰è¯­è¨€çš„ç¿»è¯‘,å†…å­˜å ç”¨æœ€å°

## æœªæ¥æ”¹è¿›

1. **æ›´å¤šè¯­è¨€æ”¯æŒ**: å¾·è¯­ã€æ³•è¯­ã€æ—¥è¯­ç­‰
2. **åœ¨çº¿ç¿»è¯‘åä½œ**: é›†æˆCrowdinç­‰å¹³å°
3. **ç¿»è¯‘è¦†ç›–ç‡**: æ‰©å±•åˆ°æ‰€æœ‰æ¨¡å—å’Œæ’ä»¶
4. **åŒºåŸŸè®¾ç½®**: æ”¯æŒæ—¥æœŸã€æ—¶é—´ã€æ•°å­—æ ¼å¼æœ¬åœ°åŒ–
5. **å³åˆ°å·¦è¯­è¨€**: æ”¯æŒé˜¿æ‹‰ä¼¯è¯­ç­‰RTLè¯­è¨€

## æ€»ç»“

å›½é™…åŒ–åŠŸèƒ½å·²å®Œæ•´å®ç°å¹¶é›†æˆåˆ°NasCodeä¸­,å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹:

- âœ… **å®Œæ•´æ€§**: æ ¸å¿ƒæ¡†æ¶ã€ç¿»è¯‘æ–‡ä»¶ã€å·¥å…·è„šæœ¬ã€æ–‡æ¡£é½å…¨
- âœ… **æ˜“ç”¨æ€§**: ç”¨æˆ·ä¸€é”®åˆ‡æ¢,å¼€å‘è€…ç®€å•ç»´æŠ¤
- âœ… **æ‰©å±•æ€§**: è½»æ¾æ·»åŠ æ–°è¯­è¨€
- âœ… **ä¸“ä¸šæ€§**: éµå¾ªQtå›½é™…åŒ–æœ€ä½³å®è·µ
- âœ… **æŒä¹…æ€§**: è¯­è¨€é€‰æ‹©è‡ªåŠ¨ä¿å­˜
- âœ… **åŠ¨æ€æ€§**: æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢

NasCodeç°åœ¨å¯ä»¥æœåŠ¡å…¨çƒç”¨æˆ·! ğŸŒ

---

**ç¼–è¯‘éªŒè¯**: âœ… æ„å»ºæˆåŠŸ,46æ¡ç¿»è¯‘ç”Ÿæ•ˆ
**æ–‡ä»¶æ•°é‡**: 9ä¸ªæ–°å¢/ä¿®æ”¹æ–‡ä»¶
**ä»£ç è¡Œæ•°**: ~500è¡Œæ–°å¢ä»£ç 
**ç¿»è¯‘æ¡ç›®**: 46æ¡(ä¸­è‹±åŒè¯­)
